---
phase: 09-visual-qa
plan: 03
type: execute
domain: swiftui
---

<objective>
Visual QA and reference alignment for overlay and reward screens: Celebration Overlay, Treasure Screen.

Purpose: Ensure reward-related screens match reference designs, critical for the autism-friendly context-preserving celebration experience.
Output: Celebration overlay and Treasure screen match references with proper visual styling.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

# Prior visual QA work:
@.planning/phases/09-visual-qa/09-01-SUMMARY.md
@.planning/phases/09-visual-qa/09-02-SUMMARY.md

# Design compliance references:
@PLAYBOOK_CONDENSED.md
@DESIGN_QA_CHECKLIST.md

# Reference images:
@design/references/screens/Reference_Celebration_Overlay.png
@design/references/screens/Reference_Treasure_Screen.png

# Current implementation files:
@BennieGame/BennieGame/Design/Components/CelebrationOverlay.swift
@BennieGame/BennieGame/Features/Treasure/TreasureView.swift

# Critical autism-friendly requirement:
**Celebration is an OVERLAY, not a new screen - child must see completed activity beneath**
**No jarring transitions - smooth scale animation 0.8→1.0 with spring ease**
</context>

<tasks>

<task type="auto">
  <name>Task 1: Celebration Overlay Visual Alignment</name>
  <files>BennieGame/BennieGame/Design/Components/CelebrationOverlay.swift</files>
  <action>
Compare current CelebrationOverlay against Reference_Celebration_Overlay.png and adjust to match:

1. **CRITICAL - Verify overlay behavior (autism-friendly):**
   - MUST be an overlay, NOT a separate screen
   - Activity beneath MUST be visible through semi-transparent background (#FAF5EB @ 85%)
   - No jarring transition - scale in from 0.8→1.0 with spring ease

2. Note exact layout from reference:
   - Praise text "Super gemacht!" (center-top, 32pt, SF Rounded Bold)
   - Coin reward "+1" with animated coin icon (below praise, 24pt)
   - Bennie + Lemminge (center, ~120x180pt, celebrating together)
   - Continue button "Weiter" (bottom center, 160x96pt wooden button)
   - Confetti particles (full screen, over everything)

3. Verify visual elements:
   - Confetti colors from approved palette (no red/neon)
   - Characters celebrating animation (arms up, joyful)
   - Wooden button styling matches rest of app
   - Golden glow on coin animation

4. Fix deviations:
   - Adjust positions to match reference
   - Ensure background transparency shows activity
   - Verify confetti particle styling
   - Check animation timing (0.3-0.5s spring ease)

AVOID: Changing coin award logic. Removing context preservation (must remain overlay).
  </action>
  <verify>Complete an activity level in simulator, verify celebration appears as overlay with activity visible beneath, compare to Reference_Celebration_Overlay.png</verify>
  <done>CelebrationOverlay matches reference, appears as proper overlay with activity visible, confetti and character celebration correct</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Celebration overlay visual alignment with autism-friendly overlay behavior</what-built>
  <how-to-verify>
    1. Launch app in simulator, select a player
    2. Navigate to any activity (e.g., Rätsel > Puzzle Matching)
    3. Complete a level successfully
    4. When celebration appears, verify:
       - Celebration is an OVERLAY - you can see the activity beneath through semi-transparent background
       - No screen flash or jarring transition occurred
       - Animation was smooth scale-in (0.8→1.0)
    5. Compare to: design/references/screens/Reference_Celebration_Overlay.png
       - Check praise text positioning
       - Verify coin animation visible
       - Confirm Bennie + Lemminge celebrating
       - Check "Weiter" button styling
       - Verify confetti particles (not distracting, approved colors)
    6. Tap "Weiter" and verify smooth transition back to activity
  </how-to-verify>
  <resume-signal>Type "approved" if overlay matches reference AND maintains context-preserving overlay behavior, or describe issues</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Treasure Screen Visual Alignment</name>
  <files>BennieGame/BennieGame/Features/Treasure/TreasureView.swift</files>
  <action>
Compare current TreasureView against Reference_Treasure_Screen.png and adjust to match:

1. Note exact layout from reference:
   - Back button "Zurück" (top left, 96x60pt)
   - Coin counter (top center, 200x50pt, current balance displayed)
   - Treasure chest (center, ~300x250pt)
     * Closed/locked if <10 coins
     * Open/glowing gold if >=10 coins
   - 5 Min option (bottom left, 200x100pt, "10 Münzen" cost label)
   - 10+2 Min option (bottom right, 200x100pt, "20 Münzen" cost label)
   - Bennie (right side, ~180x280pt, gesturing toward chest)
   - Lemminge (corners, ~60x80pt, excited)

2. Verify chest states:
   - Closed state: locked appearance, dim, chain/padlock visible
   - Open state: golden glow, coins visible inside, sparkle effects

3. Verify redemption button states:
   - Enabled (sufficient coins): warm wood, tappable
   - Disabled (insufficient coins): grayed out, not tappable
   - Show coin cost clearly on each option

4. Fix deviations:
   - Adjust chest size and position
   - Ensure redemption buttons show correct enabled/disabled state
   - Match coin counter styling

AVOID: Changing coin redemption logic. Altering YouTube integration.
  </action>
  <verify>Run simulator, navigate to Treasure screen, verify chest state matches coin balance, compare to Reference_Treasure_Screen.png</verify>
  <done>TreasureView matches reference with proper chest states, redemption button states, and character positioning</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Treasure screen visual alignment with chest states and redemption options</what-built>
  <how-to-verify>
    1. Launch app in simulator, select a player
    2. Navigate to Treasure screen from Home (tap treasure chest icon)
    3. Compare to: design/references/screens/Reference_Treasure_Screen.png
       - Check treasure chest position and size
       - Verify coin counter displays current balance
       - Check Bennie and Lemminge positions
    4. Test chest states:
       - If coins < 10: chest should be closed/dim
       - If coins >= 10: chest should be open/glowing
    5. Test redemption button states:
       - 5 min option (10 coins): enabled if balance >= 10, disabled otherwise
       - 10+2 min option (20 coins): enabled if balance >= 20, disabled otherwise
    6. Verify "Zurück" button returns to Home
  </how-to-verify>
  <resume-signal>Type "approved" if Treasure screen matches reference with correct interactive states, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] CelebrationOverlay matches Reference_Celebration_Overlay.png
- [ ] Celebration is an overlay (activity visible beneath) - CRITICAL
- [ ] Celebration animation is smooth, not jarring
- [ ] TreasureView matches Reference_Treasure_Screen.png
- [ ] Chest states (open/closed) work correctly
- [ ] Redemption button states (enabled/disabled) work correctly
- [ ] All human-verify checkpoints approved
- [ ] Build succeeds without errors
</verification>

<success_criteria>
- Celebration overlay matches reference AND preserves activity context
- Treasure screen matches reference with correct interactive states
- Human verification approved for all checkpoint tasks
- No build failures or regressions
- Phase 9 complete (all 8 reference screens validated)
</success_criteria>

<output>
After completion, create `.planning/phases/09-visual-qa/09-03-SUMMARY.md`:

# Phase 09 Plan 03: Overlays & Rewards Visual QA - Summary

**[Summary of celebration and treasure screen alignment]**

## Accomplishments

- [Celebration overlay changes]
- [Treasure screen changes]

## Files Modified

- List of files with descriptions

## Deviations Found & Fixed

[Table of original vs reference vs fix]

## Critical Verification

- [x] Celebration remains an overlay (context-preserving)
- [x] No jarring transitions

## Issues Encountered

[Problems and resolutions, or "None"]

## Phase 9 Complete

All 8 reference screens validated and aligned:
1. Loading Screen
2. Player Selection Screen
3. Home Screen (Menu)
4. Matching Game Screen
5. Numbers Game Screen
6. Labyrinth Game Screen
7. Celebration Overlay
8. Treasure Screen

Ready for Phase 10 (Voice Audio Generation)
</output>
